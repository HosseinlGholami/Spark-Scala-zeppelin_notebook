{"paragraphs":[{"text":"import org.apache.spark._\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.rdd.RDD._\n\nimport org.apache.spark.ml.linalg.{Vector, Vectors}\n","user":"anonymous","dateUpdated":"2019-11-02T13:44:07+0330","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark._\r\nimport org.apache.spark.SparkConf\r\nimport org.apache.spark.SparkContext._\r\nimport org.apache.spark.rdd.RDD._\r\nimport org.apache.spark.ml.linalg.{Vector, Vectors}\n"}]},"apps":[],"jobName":"paragraph_1572421671930_-1761250214","id":"20191030-111751_756831537","dateCreated":"2019-10-30T11:17:51+0330","dateStarted":"2019-11-02T13:44:07+0330","dateFinished":"2019-11-02T13:44:08+0330","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:578"},{"text":"//read\n\ndef parser(line:String)={\n    val num =line.split(\",\")\n    val label=num(0).toInt\n    val feature=num.drop(1).map(t=>t.toDouble)\n    (label ,Vectors.dense(feature) )\n}\n\nval training = sc.textFile(\"C:/BigData/HW2/mnist_train.txt\").map(parser).toDF(\"label\", \"features\")\nval testing = sc.textFile(\"C:/BigData/HW2/mnist_test.txt\").map(parser).toDF(\"label\", \"features\")\n","user":"anonymous","dateUpdated":"2019-11-02T13:53:38+0330","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"parser: (line: String)(Int, org.apache.spark.ml.linalg.Vector)\r\ntraining: org.apache.spark.sql.DataFrame = [label: int, features: vector]\r\ntesting: org.apache.spark.sql.DataFrame = [label: int, features: vector]\n"}]},"apps":[],"jobName":"paragraph_1572435607934_-1043712195","id":"20191030-151007_364704792","dateCreated":"2019-10-30T15:10:07+0330","dateStarted":"2019-11-02T13:53:38+0330","dateFinished":"2019-11-02T13:53:39+0330","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:579"},{"text":"import org.apache.spark.ml.classification.{DecisionTreeClassifier, DecisionTreeClassificationModel}\n\nval dtc = new DecisionTreeClassifier()\n                .setImpurity(\"entropy\")\n                .setMaxBins(255)\n                .setMaxDepth(11)\n                .setSeed(123)\n                .fit(training)\n\n\n","user":"anonymous","dateUpdated":"2019-11-02T15:06:12+0330","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":89.6,"optionOpen":false}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.classification.{DecisionTreeClassifier, DecisionTreeClassificationModel}\r\ndtc: org.apache.spark.ml.classification.DecisionTreeClassificationModel = DecisionTreeClassificationModel (uid=dtc_e7995103d7be) of depth 11 with 2885 nodes\n"}]},"apps":[],"jobName":"paragraph_1572687217160_2035265540","id":"20191102-130337_862974902","dateCreated":"2019-11-02T13:03:37+0330","dateStarted":"2019-11-02T15:06:12+0330","dateFinished":"2019-11-02T15:10:59+0330","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:580"},{"text":"val perdiction = dtc.transform(testing)\nperdiction.select(\"label\",\"prediction\").show(10)\n\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nval evaluator = new MulticlassClassificationEvaluator()\n                                .setLabelCol(\"label\")\n                                .setPredictionCol(\"prediction\")\n                                .setMetricName(\"accuracy\")\nval accuracy = evaluator.evaluate(perdiction)\n\nprintln (\"accuracy is :\"+ accuracy*100 +\" percent \\n\" )\n","user":"anonymous","dateUpdated":"2019-11-02T15:06:01+0330","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+----------+\n|label|prediction|\n+-----+----------+\n|    7|       7.0|\n|    2|       3.0|\n|    1|       1.0|\n|    0|       0.0|\n|    4|       2.0|\n|    1|       1.0|\n|    4|       9.0|\n|    9|       4.0|\n|    5|       4.0|\n|    9|       3.0|\n+-----+----------+\nonly showing top 10 rows\n\r\naccuracy is :49.18 percent \n\r\nperdiction: org.apache.spark.sql.DataFrame = [label: int, features: vector ... 3 more fields]\r\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\r\nevaluator: org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator = mcEval_903968681e0b\r\naccuracy: Double = 0.4918\n"}]},"apps":[],"jobName":"paragraph_1572443504523_-1074081122","id":"20191030-172144_256773475","dateCreated":"2019-10-30T17:21:44+0330","dateStarted":"2019-11-02T15:06:01+0330","dateFinished":"2019-11-02T15:06:03+0330","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:581"},{"text":"//2-1\n//MaxDepth => 3 to 10  \n\nval evaluator = new MulticlassClassificationEvaluator()\n                                .setLabelCol(\"label\")\n                                .setPredictionCol(\"prediction\")\n                                .setMetricName(\"accuracy\")\n\nprintln(\"%table\\nx \\ty\")\n(3 to 15).map(MaxDepth=>(MaxDepth,evaluator.evaluate{\n                                                        new DecisionTreeClassifier()\n                                                          .setImpurity(\"entropy\")\n                                                          .setMaxBins(32)\n                                                          .setMaxDepth(MaxDepth)\n                                                          .setSeed(123)\n                                                          .fit(training)\n                                                          .transform(testing)\n                                                    }\n                        )\n              ).foreach{case (x,y) => println(x + \"\\t\" + y)}","user":"anonymous","dateUpdated":"2019-11-02T14:34:33+0330","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"x ":"string","y\r":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"x ","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"y\r","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"x \ty\r\n3\t0.4911\r\n4\t0.6217\r\n5\t0.6973\r\n6\t0.7555\r\n7\t0.7954\r\n8\t0.8334\r\n9\t0.8554\r\n10\t0.873\r\n11\t0.8828\r\n12\t0.8875\r\n13\t0.8862\r\n14\t0.8861\r\n15\t0.886\r\nevaluator: org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator = mcEval_6ffe8a477863\n"}]},"apps":[],"jobName":"paragraph_1572690725612_-541967695","id":"20191102-140205_446301049","dateCreated":"2019-11-02T14:02:05+0330","dateStarted":"2019-11-02T14:16:46+0330","dateFinished":"2019-11-02T14:24:52+0330","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:582"},{"text":"//2-1\n//MaxBins => 3 to 10  \n\nval evaluator = new MulticlassClassificationEvaluator()\n                                .setLabelCol(\"label\")\n                                .setPredictionCol(\"prediction\")\n                                .setMetricName(\"accuracy\")\n\nprintln(\"%table\\nx \\ty\")\n(4 to 32 by 4).map(MaxBins=>(MaxBins,evaluator.evaluate{\n                                                        new DecisionTreeClassifier()\n                                                          .setImpurity(\"entropy\")\n                                                          .setMaxBins(MaxBins)\n                                                          .setMaxDepth(11)\n                                                          .setSeed(123)\n                                                          .fit(training)\n                                                          .transform(testing)\n                                                    }\n                        )\n              ).foreach{case (x,y) => println(x + \"\\t\" + y)}","user":"anonymous","dateUpdated":"2019-11-02T15:03:22+0330","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"x ":"string","y\r":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"x ","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"y\r","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"x \ty\r\n4\t0.8826\r\n8\t0.8846\r\n12\t0.8819\r\n16\t0.8806\r\n20\t0.8818\r\n24\t0.8807\r\n28\t0.8811\r\n32\t0.8828\r\nevaluator: org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator = mcEval_f118400deb53\n"}]},"apps":[],"jobName":"paragraph_1572691294500_1022353584","id":"20191102-141134_846022384","dateCreated":"2019-11-02T14:11:34+0330","dateStarted":"2019-11-02T14:38:39+0330","dateFinished":"2019-11-02T14:42:56+0330","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:583"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1572694359721_-1353780324","id":"20191102-150239_607439801","dateCreated":"2019-11-02T15:02:39+0330","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:585"}],"name":"HW2/2-2","id":"2EUD8C5CX","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}